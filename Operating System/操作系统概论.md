- [操作系统与硬件、其他系统软件以及用户之间的关系](#操作系统与硬件其他系统软件以及用户之间的关系)
- [操作系统的基本特征及相互关系](#操作系统的基本特征及相互关系)
  - [并发性](#并发性)
  - [共享性](#共享性)
  - [虚拟性](#虚拟性)
  - [异步性](#异步性)
- [操作系统的基本功能有哪些？](#操作系统的基本功能有哪些)
  - [处理器管理](#处理器管理)
  - [存储器管理](#存储器管理)
  - [文件管理](#文件管理)
  - [友好的用户接口](#友好的用户接口)
- [系统调用](#系统调用)
- [微内核结构](#微内核结构)

![image-20200830162658178](https://kay-rick.oss-cn-beijing.aliyuncs.com/img/20200830162659.png)





## 操作系统与硬件、其他系统软件以及用户之间的关系

<div align = "center"><img src = "https://kay-rick.oss-cn-beijing.aliyuncs.com/img/20200830170150.png" width = "700", height = "200"></img></div>

- **操作系统是覆盖在硬件上的第一层软件**，它管理计算机的硬件和软件资源，并向用户提供良好的界面。

- **操作系统与硬件紧密相关，它直接管理着硬件资源，为用户完成所有与硬件相关的操作，从而极大地方便了用户对硬件资源的使用，并提高了硬件资源的利用率**。

- **操作系统是一种特殊的系统软件，其他系统软件运行在操作系统的基础之上，可获得操作系统提供的大量服务**。也就是说，操作系统是其他系统软件和硬件之间的接口。而般用户使用计算机除了需要操作系统支持外，还需要用到大量的其他系统软件和应用软件，以使其工作更加方使和髙效。





## 操作系统的基本特征及相互关系



### 并发性

并发性是指两个或多个事件在同一时间间隔内发生。在多道程序的环境下，**并发性是指一段时间内，宏观上有多个程序在同时运行**。

> 与并发性相似的另一个概念是并行性，它是指两个或多个事件在同一时刻发生



### 共享性

**共享性是指系统中的资源可供内存中多个并发执行的进程同时使用**。根据资源性质的不同可将资源共享方式分为以下两种：

- **互斥共享**：一段时间内只能给一个进程使用，只有当这个进程使用完毕并释放这些资源后，其他进程才能使用他们。
- **同时访问**：系统中的另一类资源，它们在同一时间端内可以被多个进程同时访问。虽然这种同时是宏观上的同时，微观上可能是进程交替地访问该资源，但进程交替访问资源的顺序不会影响访问的结果。



### 虚拟性

**虚拟性是指通过某种技术，将一个物理实体变成若干个逻辑上的对应物**。用来实现虚拟性的技术被称为虚拟技术。在OS中利用虚拟技术实现了虚拟处理机、虚拟存储器和虚拟设备，从而使得进程可以更方便地共享系统资源。



### 异步性

**异步性是指在多道程序的环境下，每个程序何时执行、何时暂停都是未知的，即它们以不可预知的速度向前推进**。但同时操作系统应保证程序的执行结果是**可再现的**，即只要运行环境相同，一个作业的多次运行都会得到相同的结果。



**相互关系：**

- **并发和共享是操作系统最基本的特征**：为了提高计算机资源的利用率，OS必然要采用多道程序设计技术，使多个程序共享系统的资源，并发地执行。

- **并发和共享互为存在的条件**：一方面，资源的共享以程序(进程)的并发执行为条件。若系统不允许程序并发执行，自然不存在资源共享问题；另一方面，若系统不能对资源共享实施有效管理，协调好诸进程对共享资源的访问，也必将影响到程序的并发执行，甚至根本无法并发执行。

- **虚拟以并发和资源共享为前提**：为了使并发进程能更方便、更有效地共享资源，**操作系统常采用多种虚拟技术来在逻辑上增加CPU和设备的数量以及存储器的容量，从而解决众多并发进程对有限的系统资源的争用问题**。

- **异步性是并发和共享的必然结果**：操作系统允许多个并发进程共享资源、相互合作使得每个进程的运行过程受到其他进程的制约，不再“一气阿成”，这必然导致异步性特征的产生



## 操作系统的基本功能有哪些？



### 处理器管理

多道环境下，处理机的运行及分配都是以进程为单位，因此处理机管理可归结为进程管理。

- **进程控制**：创建/撤消进程、迁移进程状态，一般由进程控制原语完成

- **进程同步**：进程同步对进程的执行次序进行协调，使多个进程有条不紊地运行

- **进程通信**：进程通信实现进程之间信息交换，使进程能很好地相互合作
  - 直接通信：进程A发message，进程B收message
  - 间接通信：进程A发message到中间实体（如mailbox），进程B从中间实体收message

- **进程调度**：进程调度在多个就绪进程中分配处理机，并使分配到处理机的进程投入执行。

  - 作业调度：为作业分配必要资源，调入内存建立进程，并使之进入就绪队列。

  - 进程调度：从就绪队列中选出进程，分配CPU，使之运行。

  - 调度算法：FCFS、优先权等



### 存储器管理

存储管理主要是为多道程序的运行提供良好的环境，方便用户使用，且提高存贮器利用率

- **内存分配**：为每道程序分配内存空间，分配时要尽量提高内存的利用率
  - 静态分配
  - 动态分配
- **内存保护**：内存保护确保每道用户程序只在自己的内存空间中运行，从而不影响操作系统和其他程序的运行例：设置上、下界寄存器，每条指令进行越界检查（一般是硬件实现）
- **地址映射**：地址映射将程序中的逻辑地址转换成内存中的物理地址，使程序能正确执行
- **内存扩充**：内存扩充在逻辑上扩充内存的容量，以便大作业的运行和增加内存中并发作业的倒数



###设备管理

设备管理**主要是完成用户的IO请求**，它的主要功能包括：

- **缓冲管理**：缓冲管理利用缓冲来缓和CPU和IO设备速度不匹配的矛盾，提高CPU和IO设备的利用率和IO速度
- **设备分配**：设备分配为用户分配完成IO请求所需的设备和设备控制器，在配置有管道的系统中，还需为用户分配通道
- **设备处理**：设备处理启动设备进行真正的IO操作，响应并处理设备控制器发来的中断请求



### 文件管理

文件管理主要是使用户能方便、安全地使用各种信息资源，它主要功能包括：

- **文件存储空间的管理**：文件存储空间的管理为文件分配必要的存储空间，并尽量提高文件存储空间的利用率和文件访问的性能
- **目录管理**：目录管理通过目录的方式来组织文件，以实现文件的按名存取，并提高文件的检索速度
- **文件的读写管理和保护**：文件的读写管理和保护实现文件的读写操作，并提供有效的存取控制功能保护文件的安全性



### 友好的用户接口

为方便用户使用计算机，操作系统向用户提供了使用计算机的接口。该接口通常是以下列方式提供给用户的：

- 程序接口：操作系统提供了一组**系统调用**，供用户程序调用操作系统的功能。

- 用户接口



## 系统调用

// ----------todo---------

![image-20200831142911727](https://kay-rick.oss-cn-beijing.aliyuncs.com/img/20200831142913.png)

## 微内核结构

**什么是微内核结构？**

微内核的主要思想是：**在操作系统内核中只留下一些最基本的功能，而将其他服务尽可能地从内核中分离出去**，用若干个运行在用户态下的进程（即服务器进程）来实现，形成所谓的“客户/服务器”模式。普通用户进程（即客户进程）可通过内核向服务器进程发送请求，以取得操作系统的服务。

由于微内核OS结构是建立在模块化、层次化结构的基础上的，并采用了客户/服务器模式和面向对象的程序设计技术，因而它具有提高了系统的可扩展性，增强了系统的可靠性和可移植性，提供了对分布式系统的支持等优点。

**微内核结构的优点？**

- **提高了系统的灵活性和可扩充性**：在微内核结构中，OS的大部分功能都是由相对独立的服务器来实现的，用户可以根据需要选配其中的部分或全部服务器；还可以随着计算机硬件和OS技术的发展，相应地更新若干服务器或增加一些新的服务器。

- **提高了OS的可靠性**：由于所有的服务器都是运行在用户态，它们不能直接访问硬件。因此，当某个服务器出现错误时，通常只会影响到它自己，但不会引起内核和其他服务器的损坏和崩溃。
- **可移植性好**：在微内核的OS中，所有与特定CPU和IO设备硬件相关的代码，均放在内核和内核下面的硬件隐藏层中，而操作系统其他绝大部分（即各种服务器）均与硬件平台无关，因而，把操作系统移植到另一个硬件平台上所需做的改动比较小。

- **适用于分布式系统**：对用户进程(即客户)而言，如果他通过消息传递与服务器通信，那么他只需发送一个请求，然后等待服务器发来的响应，而根本无需知道这条消息是在本地机就地处理还是通过网络送给远地机上的服务器。

